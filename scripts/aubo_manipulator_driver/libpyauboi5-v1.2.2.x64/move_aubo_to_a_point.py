#! /usr/bin/env python
# coding=utf-8
import math
from robotcontrol import *

def deg_to_rad(tuplelist):
    dd=[]
    for i in tuplelist:
        dd.append(i*math.pi/180)
    return tuple(dd)
def main(test_count):
    # 初始化logger
    logger_init()

    # 启动测试
    logger.info("{0} test beginning...".format(Auboi5Robot.get_local_time()))

    # 系统初始化
    Auboi5Robot.initialize()

    # 创建机械臂控制类
    robot = Auboi5Robot()

    # 创建上下文
    handle = robot.create_context()

    # 打印上下文
    logger.info("robot.rshd={0}".format(handle))
    try:

        # 链接服务器
        ip = '192.168.1.11'
        port = 8899
        result = robot.connect(ip, port)

        if result != RobotErrorType.RobotError_SUCC:
            logger.info("connect server{0}:{1} failed.".format(ip, port))
        else:
            # # 重新上电
            # robot.robot_shutdown()
            #
            # # 上电
            robot.robot_startup()
            #
            # # 设置碰撞等级
            # robot.set_collision_class(7)

            # 设置工具端电源为１２ｖ
            # robot.set_tool_power_type(RobotToolPowerType.OUT_12V)

            # 设置工具端ＩＯ_0为输出
            robot.set_tool_io_type(RobotToolIoAddr.TOOL_DIGITAL_IO_0, RobotToolDigitalIoDir.IO_OUT)

            # 获取工具端ＩＯ_0当前状态
            tool_io_status = robot.get_tool_io_status(RobotToolIoName.tool_io_0)
            logger.info("tool_io_0={0}".format(tool_io_status))

            # 设置工具端ＩＯ_0状态
            robot.set_tool_io_status(RobotToolIoName.tool_io_0, 1)

            # 获取控制柜用户DI
            io_config = robot.get_board_io_config(RobotIOType.User_DI)

            # 输出DI配置
            logger.info(io_config)

            # 获取控制柜用户DO
            io_config = robot.get_board_io_config(RobotIOType.User_DO)

            # 输出DO配置
            logger.info(io_config)

            # 当前机械臂是否运行在联机模式
            logger.info("robot online mode is {0}".format(robot.is_online_mode()))

            # 循环测试
            while test_count > 0:
                test_count -= 1

                joint_status = robot.get_joint_status()
                logger.info("joint_status={0}".format(joint_status))

                # 初始化全局配置文件
                robot.init_profile()

                # 设置关节最大加速度
                # robot.set_joint_maxacc((5.5, 5.5, 5.5, 5.5, 5.5, 5.5))
                #
                # # 设置关节最大加速度
                # robot.set_joint_maxvelc((1.5, .5, 2.5, 2.5, 2.5, 2.5))
                # 设置关节最大加速度
                robot.set_joint_maxacc((3.5, 3.5, 3.5, 3.5, 3.5, 3.5))

                # 设置关节最大加速度
                robot.set_joint_maxvelc((2.5, 2.5, 2.5, 2.5, 2.5, 2.5))
                # 设置机械臂末端最大线加速度(m/s)
                robot.set_end_max_line_acc(0.5)
                logger.info("-------go-----to-----start-------step--01")
                # 获取机械臂末端最大线加速度(m/s)
                # robot.set_end_max_line_velc(0.2)
                robot.set_end_max_line_velc(0.5)
                
                # joint_radian = deg_to_rad((-3.07,-2.094,80.07,64.0747,95.11,89.98))#((0,0,0,0,0,0))
                # joint_radian=(0.710393681906976, 
                #     -1.3977020494122865, 
                #     1.3012983964751612, 
                #     -0.4425922077023454, 
                #     -0.8604026448879205, 
                #     1.5707963267948966)
                dictdata={
                "aubo_data_num_0": [
                    -0.2852509833270265, 
                    -0.5320376301933496, 
                    1.3666906155038931, 
                    -1.2428644078925508, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_1": [
                    -0.2852509833270265, 
                    -1.3977020494122865, 
                    1.3012983964751612, 
                    -0.4425922077023463, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_10": [
                    0.5618970771701566, 
                    -1.1296965071139962, 
                    1.5943011767024613, 
                    -0.41759496977333566, 
                    -1.00889924962474, 
                    1.5707963267948966
                ], 
                "aubo_data_num_11": [
                    0.3869656804872541, 
                    -1.106874138764793, 
                    1.675974889619579, 
                    -0.35874362520542036, 
                    -1.1838306463076425, 
                    1.5707963267948966
                ], 
                "aubo_data_num_12": [
                    0.1928196864056666, 
                    -1.1025649630873504, 
                    1.6923767941285766, 
                    -0.34665089637386615, 
                    -1.37797664038923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_13": [
                    -0.006911151382952951, 
                    -1.1157544018866634, 
                    1.6432516279699083, 
                    -0.3825866237332214, 
                    -1.5777074781778495, 
                    1.5707963267948966
                ], 
                "aubo_data_num_14": [
                    -0.19720286206501747, 
                    -1.1493781329542445, 
                    1.5291012837899505, 
                    -0.46311323684559724, 
                    -1.767999188859914, 
                    1.5707963267948966
                ], 
                "aubo_data_num_15": [
                    -0.2852509833270265, 
                    -1.1756504138805868, 
                    1.447317763230986, 
                    -0.5186244764782204, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_16": [
                    -0.2852509833270265, 
                    -0.9698667703466137, 
                    1.525512678114401, 
                    -0.6462132051287792, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_17": [
                    -0.10404845263424978, 
                    -0.9122724013651746, 
                    1.6723704343385029, 
                    -0.5569498178861156, 
                    -1.6748447794291463, 
                    1.5707963267948966
                ], 
                "aubo_data_num_18": [
                    0.0926657237573929, 
                    -0.881478193954667, 
                    1.754713012377593, 
                    -0.5054014472575323, 
                    -1.4781306030375037, 
                    1.5707963267948966
                ], 
                "aubo_data_num_19": [
                    0.291553629293527, 
                    -0.8754229379259613, 
                    1.771315378225701, 
                    -0.4948543374381291, 
                    -1.2792426975013695, 
                    1.5707963267948966
                ], 
                "aubo_data_num_2": [
                    -0.10404845263424978, 
                    -1.3585387012030194, 
                    1.450929678693564, 
                    -0.3321242736932106, 
                    -1.6748447794291463, 
                    1.5707963267948966
                ], 
                "aubo_data_num_20": [
                    0.4774621968255568, 
                    -0.8936934039820112, 
                    1.7216566830312452, 
                    -0.5262425665765376, 
                    -1.0933341299693398, 
                    1.5707963267948966
                ], 
                "aubo_data_num_21": [
                    0.6396125004263311, 
                    -0.9375194575565207, 
                    1.6070181340444059, 
                    -0.5970550619888675, 
                    -0.9311838263685654, 
                    1.5707963267948966
                ], 
                "aubo_data_num_22": [
                    0.710393681906976, 
                    -0.9698667703466137, 
                    1.525512678114401, 
                    -0.6462132051287783, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_23": [
                    0.710393681906976, 
                    -0.787040253980912, 
                    1.53823360029741, 
                    -0.8163187993114711, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_24": [
                    0.710393681906976, 
                    -0.787040253980912, 
                    1.53823360029741, 
                    -0.8163187993114711, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_25": [
                    0.5618970771701566, 
                    -0.7155338106316487, 
                    1.685156170881549, 
                    -0.7409026720765954, 
                    -1.00889924962474, 
                    1.5707963267948966
                ], 
                "aubo_data_num_26": [
                    0.3869656804872541, 
                    -0.675382042763748, 
                    1.7676582141393826, 
                    -0.6985523966866616, 
                    -1.1838306463076425, 
                    1.5707963267948966
                ], 
                "aubo_data_num_27": [
                    0.1928196864056666, 
                    -0.6672815734353001, 
                    1.7843039869507429, 
                    -0.6900070932037501, 
                    -1.37797664038923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_28": [
                    -0.006911151382952951, 
                    -0.6915057633574451, 
                    1.734526860301008, 
                    -0.71556002993134, 
                    -1.5777074781778495, 
                    1.5707963267948966
                ], 
                "aubo_data_num_29": [
                    -0.19720286206501747, 
                    -0.7473715114121484, 
                    1.6197409548745876, 
                    -0.7744801873030571, 
                    -1.767999188859914, 
                    1.5707963267948966
                ], 
                "aubo_data_num_3": [
                    0.0926657237573929, 
                    -1.3406912068227275, 
                    1.5326893522791156, 
                    -0.26821209448795, 
                    -1.4781306030375037, 
                    1.5707963267948966
                ], 
                "aubo_data_num_30": [
                    -0.2852509833270265, 
                    -0.787040253980912, 
                    1.53823360029741, 
                    -0.8163187993114711, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_31": [
                    -0.2852509833270265, 
                    -0.6376332132456559, 
                    1.4856621047642644, 
                    -1.018297335579872, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_32": [
                    -0.2852509833270265, 
                    -0.6376332132456559, 
                    1.4856621047642644, 
                    -1.0182973355798728, 
                    -1.856047310121923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_33": [
                    -0.10404845263424978, 
                    -0.5527161237767864, 
                    1.632471710194447, 
                    -0.9564048196185588, 
                    -1.6748447794291463, 
                    1.5707963267948966
                ], 
                "aubo_data_num_34": [
                    0.0926657237573929, 
                    -0.5038669893687757, 
                    1.7144078158299365, 
                    -0.92331784839108, 
                    -1.4781306030375037, 
                    1.5707963267948966
                ], 
                "aubo_data_num_35": [
                    0.291553629293527, 
                    -0.4938904237631583, 
                    1.7308941334451866, 
                    -0.9168080963814491, 
                    -1.2792426975013695, 
                    1.5707963267948966
                ], 
                "aubo_data_num_36": [
                    0.4774621968255568, 
                    -0.5235992716364901, 
                    1.6815481275619346, 
                    -0.9364452543913684, 
                    -1.0933341299693398, 
                    1.5707963267948966
                ], 
                "aubo_data_num_37": [
                    0.6396125004263311, 
                    -0.5908187532119982, 
                    1.5672469607691992, 
                    -0.9835269396085966, 
                    -0.9311838263685654, 
                    1.5707963267948966
                ], 
                "aubo_data_num_38": [
                    0.710393681906976, 
                    -0.6376332132456559, 
                    1.4856621047642653, 
                    -1.018297335579872, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_39": [
                    0.710393681906976, 
                    -0.5320376301933489, 
                    1.3666906155038934, 
                    -1.24286440789255, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_4": [
                    0.291553629293527, 
                    -1.3374834022517916, 
                    1.5489932591846554, 
                    -0.2551159921533461, 
                    -1.2792426975013695, 
                    1.5707963267948966
                ], 
                "aubo_data_num_40": [
                    0.5618970771701566, 
                    -0.4357762471109474, 
                    1.5147431728490348, 
                    -1.1910732336298109, 
                    -1.00889924962474, 
                    1.5707963267948966
                ], 
                "aubo_data_num_41": [
                    0.3869656804872541, 
                    -0.38017070398040786, 
                    1.5962573327202154, 
                    -1.1651646168891698, 
                    -1.1838306463076425, 
                    1.5707963267948966
                ], 
                "aubo_data_num_42": [
                    0.1928196864056666, 
                    -0.3687873728896278, 
                    1.6125631364941686, 
                    -1.1602421442059958, 
                    -1.37797664038923, 
                    1.5707963267948966
                ], 
                "aubo_data_num_43": [
                    -0.006911151382952951, 
                    -0.40265751725087906, 
                    1.5636616970128756, 
                    -1.1752734393260384, 
                    -1.5777074781778495, 
                    1.5707963267948966
                ], 
                "aubo_data_num_44": [
                    -0.19720286206501747, 
                    -0.4790186879693499, 
                    1.4492880965989263, 
                    -1.213285869021517, 
                    -1.767999188859914, 
                    1.5707963267948966
                ], 
                "aubo_data_num_45": [
                    -0.36750307098808044, 
                    -0.5948868290132081, 
                    1.2656109527386388, 
                    -1.2810948718379462, 
                    -1.938299397782977, 
                    1.5707963267948966
                ], 
                "aubo_data_num_5": [
                    0.4774621968255568, 
                    -1.3474762156388405, 
                    1.5000467419169539, 
                    -0.2940696960339988, 
                    -1.0933341299693398, 
                    1.5707963267948966
                ], 
                "aubo_data_num_6": [
                    0.6396125004263311, 
                    -1.3748617151950873, 
                    1.3849631166518037, 
                    -0.38176782174290214, 
                    -0.9311838263685654, 
                    1.5707963267948966
                ], 
                "aubo_data_num_7": [
                    0.710393681906976, 
                    -1.3977020494122865, 
                    1.3012983964751612, 
                    -0.4425922077023454, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_8": [
                    0.710393681906976, 
                    -1.1756504138805868, 
                    1.447317763230986, 
                    -0.5186244764782195, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ], 
                "aubo_data_num_9": [
                    0.710393681906976, 
                    -1.1756504138805868, 
                    1.447317763230986, 
                    -0.5186244764782195, 
                    -0.8604026448879205, 
                    1.5707963267948966
                ]
            }
                for i in range(len(dictdata)):
                    joint_radian=tuple(dictdata["aubo_data_num_"+str(i)])
                    logger.info("move joint to {0}".format(joint_radian))
                    robot.move_joint(joint_radian)


            # 断开服务器链接
            robot.disconnect()

    except RobotError, e:
        logger.error("{0} robot Event:{1}".format(robot.get_local_time(), e))

    finally:
        # 断开服务器链接
        if robot.connected:
            # 关闭机械臂
            robot.robot_shutdown()
            # 断开机械臂链接
            robot.disconnect()
        # 释放库资源
        Auboi5Robot.uninitialize()
        logger.info("{0} test completed.".format(Auboi5Robot.get_local_time()))

if __name__=="__main__":
    main(1)
    # print deg_to_rad((-3.3364,12.406,-81.09,-91.207,-86.08,0.164))